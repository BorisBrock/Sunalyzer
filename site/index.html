<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Sunalyzer</title>
    <link href="css/styles.css" rel="stylesheet" />
    <link href="css/custom.css" rel="stylesheet" />
    <link href="lib/bootstrap.min.css" rel="stylesheet" />
    <link href="lib/fontawesome/css/all.min.css" rel="stylesheet" />
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
        <!-- Sidebar Toggle -->
        <button class="btn btn-link order-0 me-2 ms-2" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>

        <!-- Logo -->
        <a class="navbar-brand ps-3" href="index.html"><img src="favicon.ico" width="26" height="26">
            Sunalyzer</a>

        <!-- More settings -->
        <ul class="navbar-nav ms-auto pe-4">
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbar_dropdown_language" role="button"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    Language
                </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <li><a class="dropdown-item" href="javascript:switchLanguageToEnglish();">English</a></li>
                    <li><a class="dropdown-item" href="javascript:switchLanguageToGerman();">Deutsch</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    <!-- Sidebar -->
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion sb-sidenav-dark sunalyzer-sidebar" id="sidenavAccordion">
                <div class="sb-sidenav-menu">

                    <div class="nav">

                        <!-- Dashboard -->
                        <div class="sb-sidenav-menu-heading" id="sidebar_headline_overview">Overview</div>
                        <a class="nav-link" href="javascript:showViewDashboard();collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-grip"></i></div>
                            Dashboard
                        </a>
                        <a class="nav-link" href="javascript:showViewHistory(histories.TODAY);collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-star"></i></div>
                            <div id="sidebar_today">Today</div>
                        </a>

                        <!-- History -->
                        <div class="sb-sidenav-menu-heading" id="sidebar_headline_history">History</div>
                        <a class="nav-link" href="javascript:showViewHistory(histories.DAY);collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-calendar-day"></i></div>
                            <div id="sidebar_by_day">By Day</div>
                        </a>
                        <a class="nav-link" href="javascript:showViewHistory(histories.MONTH);collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-calendar-days"></i></div>
                            <div id="sidebar_by_month">By Month</div>
                        </a>
                        <a class="nav-link" href="javascript:showViewHistory(histories.YEAR);collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-calendar-week"></i></div>
                            <div id="sidebar_by_year">By Year</div>
                        </a>
                        <a class="nav-link" href="javascript:showViewHistory(histories.ALL);collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-calendar"></i></div>
                            <div id="sidebar_all_time">All Time</div>
                        </a>

                        <!-- Misc -->
                        <div class="sb-sidenav-menu-heading" id="sidebar_headline_misc">Misc</div>
                        <a class="nav-link" href="javascript:showViewCsv();collapseSidebar();">
                            <div class="sb-nav-link-icon"><i class="fas fa-file-csv"></i></div>
                            <div id="sidebar_csv">CSV Download</div>
                        </a>
                    </div>
                </div>
                <div class="sb-sidenav-footer bg-dark">
                    <div class="small" id="version">Version 0.0.0</div>
                    <div id="time">...</div>
                </div>
            </nav>
        </div>

        <div id="layoutSidenav_content">
            <main>

                <!-- Dashbord View -->
                <div class="container-fluid px-4" id="view_dashboard">
                    <h1 class="mt-4">Dashboard</h1>
                    <ol class="breadcrumb mb-4">
                        <li class="breadcrumb-item active"><span id="dashboard_subtitle">Last updated:</span><span
                                id="dashboard_subtitle_time">...</span></li>
                    </ol>

                    <div class="row row-cols-1 row-cols-md-2">

                        <!-- Column Current -->
                        <div class="col-xl-4">
                            <div class="card mb-4">
                                <div class="card-header h5">
                                    <span id="dash_card_current">Current</span>
                                </div>
                                <div class="card-body">
                                    <table class="table table-borderless">
                                        <tbody>
                                            <tr>
                                                <td><i class="fas fa-solar-panel me-1"></i></td>
                                                <td id="dash_text_currently_produced">Currently produced</td>
                                                <td id="dash_currently_produced">0.0</td>
                                                <td>kW</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-lightbulb me-1"></i></td>
                                                <td id="dash_text_currently_consumed">Currently consumed</td>
                                                <td id="dash_currently_consumed">0.0</td>
                                                <td>kW</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                <td id="dash_text_currently_fed_in">Currently fed in</td>
                                                <td id="dash_currently_fed_in">0.0</td>
                                                <td>kW</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Column Today -->
                        <div class="col-xl-4">
                            <div class="card mb-4">
                                <div class="card-header h5">
                                    <span id="dash_card_today">Today</span>
                                </div>
                                <div class="card-body">
                                    <table class="table table-borderless">
                                        <tbody>
                                            <tr>
                                                <td><i class="fas fa-solar-panel me-1"></i></td>
                                                <td id="dash_text_today_produced">Produced</td>
                                                <td id="dash_today_produced">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-lightbulb me-1"></i></td>
                                                <td id="dash_text_today_consumed">Consumed</td>
                                                <td id="dash_today_consumed">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                <td id="dash_text_today_fed_in">Fed in</td>
                                                <td id="dash_today_fed_in">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-solar-panel me-1"></i></td>
                                                <td id="dash_text_today_earned">Earnings</td>
                                                <td id="dash_today_earned">0.0</td>
                                                <td>€</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Column All Time -->
                        <div class="col-xl-4">
                            <div class="card mb-4">
                                <div class="card-header h5">
                                    <span id="dash_card_all_time">All Time</span>
                                </div>
                                <div class="card-body">
                                    <table class="table table-borderless">
                                        <tbody>
                                            <tr>
                                                <td><i class="fas fa-solar-panel me-1"></i></td>
                                                <td id="dash_text_all_time_produced">Produced</td>
                                                <td id="dash_all_time_produced">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-lightbulb me-1"></i></td>
                                                <td id="dash_text_all_time_consumed">Consumed</td>
                                                <td id="dash_all_time_consumed">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                <td id="dash_text_all_time_fed_in">Fed in</td>
                                                <td id="dash_all_time_fed_in">0.0</td>
                                                <td>kWh</td>
                                            </tr>
                                            <tr>
                                                <td><i class="fas fa-sack-dollar me-1"></i></td>
                                                <td id="dash_text_all_time_earned">Earnings</td>
                                                <td id="dash_all_time_earned">0.0</td>
                                                <td>€</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row row-cols-1">

                        <!-- Dashboard card with 24h graph -->
                        <div class="col">
                            <div class="card mb-4">
                                <div class="card-header h5">
                                    <span id="dash_card_24h">All Time</span>
                                </div>
                                <div class="card-body">
                                    <canvas id="chart_dashboard" height="250"></canvas>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- History View -->
                <div class="container-fluid px-4" id="view_history">
                    <h1 class="mt-4" id="headline_history">...</h1>

                    <div class="row py-4">
                        <div class="col-xl-6">
                            <div class="d-flex flex-row">
                                <!-- Year -->
                                <div id="selection_year">
                                    <select class="form-select" aria-label="Default select example" id="selection_year2"
                                        onchange="updateHistoryStats();">
                                    </select>
                                </div>
                                <!-- Month -->
                                <div id="selection_month">
                                    <select class="form-select" aria-label="Default select example"
                                        id="selection_month2" onchange="updateHistoryStats();">
                                        <option value="1" id="cbx_month_1">January</option>
                                        <option value="2" id="cbx_month_2">February</option>
                                        <option value="3" id="cbx_month_3">March</option>
                                        <option value="4" id="cbx_month_4">April</option>
                                        <option value="5" id="cbx_month_5">May</option>
                                        <option value="6" id="cbx_month_6">June</option>
                                        <option value="7" id="cbx_month_7">July</option>
                                        <option value="8" id="cbx_month_8">August</option>
                                        <option value="9" id="cbx_month_9">September</option>
                                        <option value="10" id="cbx_month_10">October</option>
                                        <option value="11" id="cbx_month_11">November</option>
                                        <option value="12" id="cbx_month_12">December</option>
                                    </select>
                                </div>
                                <!-- Day -->
                                <div id="selection_day">
                                    <select class="form-select" aria-label="Default select example" id="selection_day2"
                                        onchange="updateHistoryStats();">
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="row_history_data">

                        <div class="row row-cols-1 row-cols-md-2">

                            <!-- Card Production -->
                            <div class="col-xl-4">
                                <div class="card mb-4">
                                    <div class="card-header h5">
                                        <span id="history_card_usage">Usage of Produced Energy</span>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr class="fw-bold">
                                                    <td><i class="fas fa-solar-panel me-1"></i></td>
                                                    <td id="history_text_produced">Energy produced</td>
                                                    <td id="history_stat_produced">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div>
                                            <canvas id="chart_usage" height="200"></canvas>
                                        </div>
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr>
                                                    <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                    <td id="history_text_fedin">Fed into the grid</td>
                                                    <td id="history_stat_fedin">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-lightbulb me-1"></i></td>
                                                    <td id="history_text_self_consumed">Self consumed</td>
                                                    <td id="history_stat_self_consumed">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Card Consumption -->
                            <div class="col-xl-4">
                                <div class="card mb-4">
                                    <div class="card-header h5">
                                        <span id="history_card_consumption">Power Consumption</span>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr class="fw-bold">
                                                    <td><i class="fas fa-lightbulb me-1"></i></td>
                                                    <td id="history_text_consumption_total">Total consumption</td>
                                                    <td id="history_stat_consumption_total">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div>
                                            <canvas id="chart_consumption" height="200"></canvas>
                                        </div>
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr>
                                                    <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                    <td id="history_text_consumption_grid">Consumption from grid</td>
                                                    <td id="history_stat_consumption_grid">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-solar-panel me-1"></i></td>
                                                    <td id="history_text_consumption_self">Consumption from PV</td>
                                                    <td id="history_stat_consumption_self">0.0</td>
                                                    <td>kWh</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>


                            <div class="col-xl-4">

                                <!-- Card Autarky -->
                                <div class="card mb-4">
                                    <div class="card-header h5">
                                        <span id="history_card_autarky">Autarky</span>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr>
                                                    <td><i class="fas fa-leaf me-1"></i></td>
                                                    <td id="history_text_autarky">Autarky</td>
                                                    <td id="history_stat_autarky">0</td>
                                                    <td>%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Card Earnings -->
                                <div class="card mb-4">
                                    <div class="card-header h5">
                                        <span id="history_card_earned">Earnings</span>
                                    </div>
                                    <div class="card-body">
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr>
                                                    <td><i class="fas fa-plug-circle-bolt me-1"></i></td>
                                                    <td id="history_text_earned_feedin">Earned with feed-in</td>
                                                    <td id="history_stat_earned_feedin">0.0</td>
                                                    <td>€</td>
                                                </tr>
                                                <tr>
                                                    <td><i class="fas fa-lightbulb me-1"></i></td>
                                                    <td id="history_text_earned_self">Saved via self-consumption</td>
                                                    <td id="history_stat_earned_self">0.0</td>
                                                    <td>€</td>
                                                </tr>
                                                <tr class="fw-bold">
                                                    <td><i class="fas fa-sack-dollar me-1"></i></td>
                                                    <td id="history_text_earned_total">Total</td>
                                                    <td id="history_stat_earned_total">0.0</td>
                                                    <td>€</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div id="history_card_graphs">
                            <div class="row row-cols-1 row-cols-md-2">

                                <!-- Left graph: production -->
                                <div class="col-sm">
                                    <div class="card mb-4">
                                        <div class="card-header h5">
                                            <span id="history_card_graph_production_text">Details</span>
                                        </div>
                                        <div class="card-body">
                                            <canvas id="chart_history_details_production" height="250"></canvas>
                                        </div>
                                    </div>
                                </div>

                                <!-- Right graph: consumption -->
                                <div class="col-sm">
                                    <div class="card mb-4">
                                        <div class="card-header h5">
                                            <span id="history_card_graph_consumption_text">Details</span>
                                        </div>
                                        <div class="card-body">
                                            <canvas id="chart_history_details_consumption" height="250"></canvas>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>

                    <!-- No data -->
                    <div class="row" id="row_error_banner">
                        <div class="alert alert-primary" role="alert">
                            <i class="fas fa-circle-info me-1"></i>
                            <span id="info_no_data">No data is available for the selected time span.</span>
                        </div>
                    </div>

                </div>

                <!-- CSV Download View -->
                <div class="container-fluid px-4" id="view_csv">
                    <h1 class="mt-4">CSV Download</h1>
                    <ol class="breadcrumb mb-4">
                        <li class="breadcrumb-item active"><span id="csv_subtitle">...</span></li>
                    </ol>


                    <div class="container">

                        <div class="row pt-5">
                            <div class="col-md-3">
                                <label class="fs-4" id="csv_label_time_range">Time range:</label>
                            </div>
                            <div class="col-md">
                                <input type="radio" class="btn-check" name="options_range" id="csv_range_rad_day"
                                    autocomplete="off" onclick="updateCsvDateSelector();">
                                <label class="btn btn-outline-primary" for="csv_range_rad_day"
                                    id="csv_range_rad_lbl_day">One day</label>

                                <input type="radio" class="btn-check" name="options_range" id="csv_range_rad_month"
                                    autocomplete="off" onclick="updateCsvDateSelector();">
                                <label class="btn btn-outline-primary" for="csv_range_rad_month"
                                    id="csv_range_rad_lbl_month">One month</label>

                                <input type="radio" class="btn-check" name="options_range" id="csv_range_rad_year"
                                    autocomplete="off" onclick="updateCsvDateSelector();" checked>
                                <label class="btn btn-outline-primary" for="csv_range_rad_year"
                                    id="csv_range_rad_lbl_year">One year</label>

                                <input type="radio" class="btn-check" name="options_range" id="csv_range_rad_all"
                                    autocomplete="off" onclick="updateCsvDateSelector();">
                                <label class="btn btn-outline-primary" for="csv_range_rad_all"
                                    id="csv_range_rad_lbl_all">All time</label>
                            </div>
                        </div>

                        <div class="row pt-2">
                            <div class="col-md-3">
                            </div>
                            <div class="col-md">
                                <div class="d-flex flex-row">
                                    <!-- Year -->
                                    <div id="csv_selection_year">
                                        <select class="form-select" aria-label="Default select example"
                                            id="csv_selection_year2">
                                        </select>
                                    </div>
                                    <!-- Month -->
                                    <div id="csv_selection_month">
                                        <select class="form-select" aria-label="Default select example"
                                            id="csv_selection_month2">
                                            <option value="1" id="csv_cbx_month_1">January</option>
                                            <option value="2" id="csv_cbx_month_2">February</option>
                                            <option value="3" id="csv_cbx_month_3">March</option>
                                            <option value="4" id="csv_cbx_month_4">April</option>
                                            <option value="5" id="csv_cbx_month_5">May</option>
                                            <option value="6" id="csv_cbx_month_6">June</option>
                                            <option value="7" id="csv_cbx_month_7">July</option>
                                            <option value="8" id="csv_cbx_month_8">August</option>
                                            <option value="9" id="csv_cbx_month_9">September</option>
                                            <option value="10" id="csv_cbx_month_10">October</option>
                                            <option value="11" id="csv_cbx_month_11">November</option>
                                            <option value="12" id="csv_cbx_month_12">December</option>
                                        </select>
                                    </div>
                                    <!-- Day -->
                                    <div id="csv_selection_day">
                                        <select class="form-select" aria-label="Default select example"
                                            id="csv_selection_day2">
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row pt-4">
                            <div class="col-md-3">
                                <label class="fs-4" id="csv_label_resolution">Resolution:</label>
                            </div>
                            <div class="col-md">
                                <input type="radio" class="btn-check" name="options_res" id="csv_res_rad_day"
                                    autocomplete="off" checked>
                                <label class="btn btn-outline-primary" for="csv_res_rad_day"
                                    id="csv_res_rad_lbl_day">Single days</label>

                                <input type="radio" class="btn-check" name="options_res" id="csv_res_rad_month"
                                    autocomplete="off">
                                <label class="btn btn-outline-primary" for="csv_res_rad_month"
                                    id="csv_res_rad_lbl_month">Summed up by
                                    month</label>

                                <input type="radio" class="btn-check" name="options_res" id="csv_res_rad_year"
                                    autocomplete="off">
                                <label class="btn btn-outline-primary" for="csv_res_rad_year"
                                    id="csv_res_rad_lbl_year">Summed up by year</label>
                            </div>
                        </div>

                        <div class="row pt-5">
                            <div class="col-md-2">
                                <button type="button" class="btn btn-success btn-lg" onclick="downloadCsv();"><i
                                        class="fas fa-download me-2"></i>Download</button>
                            </div>
                        </div>
                    </div>

                </div>

            </main>
        </div>
    </div>
    <script src="lib/bootstrap.bundle.min.js"></script>
    <script src="js/version.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/localization.js"></script>
    <script src="js/csv.js"></script>
    <script src="lib/chart.min.js" crossorigin="anonymous"></script>
    <script src="lib/chartjs-plugin-labels.min.js"></script>
    <script src="js/chart_factory.js"></script>
    <script src="js/main.js"></script>
</body>

</html>